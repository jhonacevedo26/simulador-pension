<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Pensi√≥n - Diagn√≥stico Personalizado</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0A2540;
            --primary-light: #1a3a5c;
            --accent: #00D4AA;
            --accent-dark: #00b894;
            --warning: #FF6B6B;
            --bg-light: #F8FAFC;
            --bg-card: #FFFFFF;
            --text-primary: #0A2540;
            --text-secondary: #64748B;
            --border: #E2E8F0;
            --shadow: 0 4px 6px -1px rgba(10, 37, 64, 0.1), 0 2px 4px -2px rgba(10, 37, 64, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(10, 37, 64, 0.1), 0 8px 10px -6px rgba(10, 37, 64, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 24px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(0, 212, 170, 0.15) 0%, transparent 70%);
            border-radius: 50%;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: white;
            margin-bottom: 12px;
            position: relative;
        }

        .header p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.1rem;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
        }

        /* Progress Steps */
        .progress-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--bg-card);
            border-radius: 50px;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .progress-step.active {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(0, 212, 170, 0.05) 100%);
        }

        .progress-step.completed {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
        }

        .step-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .progress-step.active .step-number {
            background: var(--accent);
            color: white;
        }

        .progress-step.completed .step-number {
            background: white;
            color: var(--accent);
        }

        .step-label {
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Card */
        .card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 32px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            margin-bottom: 24px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        /* Form Elements */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .label-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .label-hint {
            font-weight: 400;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        /* Tooltip */
        .tooltip-container {
            position: relative;
            display: inline-flex;
        }

        .tooltip-icon {
            width: 18px;
            height: 18px;
            background: var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-secondary);
            cursor: help;
            transition: all 0.3s ease;
        }

        .tooltip-icon:hover {
            background: var(--accent);
            color: white;
        }

        .tooltip-text {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 400;
            width: 280px;
            text-align: left;
            z-index: 100;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            line-height: 1.5;
        }

        .tooltip-text::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--primary);
        }

        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        input, select {
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            background: var(--bg-light);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 4px rgba(0, 212, 170, 0.1);
        }

        /* Gender Toggle */
        .gender-toggle {
            display: flex;
            gap: 12px;
        }

        .gender-option {
            flex: 1;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-light);
        }

        .gender-option:hover {
            border-color: var(--accent);
        }

        .gender-option.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(0, 212, 170, 0.05) 100%);
        }

        .gender-option input {
            display: none;
        }

        .gender-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .gender-label {
            font-weight: 600;
        }

        /* Buttons */
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            box-shadow: 0 4px 14px rgba(0, 212, 170, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 170, 0.5);
        }

        .btn-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            background: white;
        }

        .btn-download {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            box-shadow: 0 4px 14px rgba(10, 37, 64, 0.3);
        }

        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(10, 37, 64, 0.4);
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        /* Results Section */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .result-card {
            background: var(--bg-light);
            border-radius: 16px;
            padding: 20px;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            border-color: var(--accent);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .result-card.highlight {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.08) 0%, rgba(0, 212, 170, 0.02) 100%);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .result-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
        }

        .result-icon.colpensiones { background: #E8F5E9; }
        .result-icon.privado { background: #E3F2FD; }
        .result-icon.reforma { background: #FFF3E0; }

        .result-title {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--primary);
        }

        .result-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .result-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .result-range {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Resumen Ejecutivo */
        .resumen-ejecutivo {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 24px;
        }

        .resumen-ejecutivo h3 {
            color: var(--accent);
            margin-bottom: 16px;
            font-size: 1.1rem;
        }

        .resumen-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .resumen-item {
            text-align: center;
            padding: 16px 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
        }

        .resumen-item.alerta {
            background: rgba(255,107,107,0.3);
            border: 2px solid var(--warning);
        }

        .resumen-item-label {
            font-size: 0.8rem;
            opacity: 0.85;
            margin-bottom: 6px;
        }

        .resumen-item-value {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .resumen-item.alerta .resumen-item-value {
            color: var(--warning);
        }

        .alerta-box {
            background: rgba(255,107,107,0.2);
            border-left: 4px solid var(--warning);
            padding: 16px;
            border-radius: 0 12px 12px 0;
            margin-top: 16px;
        }

        .alerta-box p {
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .alerta-box strong {
            color: var(--warning);
        }

        /* Brecha Card */
        .brecha-card {
            background: linear-gradient(135deg, var(--warning) 0%, #ee5a5a 100%);
            color: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            margin-bottom: 24px;
        }

        .brecha-card h3 {
            font-size: 1rem;
            margin-bottom: 8px;
            opacity: 0.9;
        }

        .brecha-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .brecha-text {
            font-size: 0.9rem;
            opacity: 0.9;
            max-width: 450px;
            margin: 0 auto;
        }

        .porcentaje-reduccion {
            display: inline-block;
            background: rgba(0,0,0,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            margin-top: 12px;
            font-size: 0.9rem;
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(0, 212, 170, 0.05) 100%);
            border: 2px solid var(--accent);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .info-box h4 {
            color: var(--accent-dark);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .info-box p {
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .estrategias-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .estrategia-tag {
            background: white;
            border: 1px solid var(--accent);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--accent-dark);
            font-weight: 500;
        }

        /* CTA Box */
        .cta-box {
            background: var(--primary);
            color: white;
            padding: 24px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 24px;
        }

        .cta-box h4 {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .cta-box p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        /* Summary Stats */
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .stat-item {
            text-align: center;
            padding: 16px;
            background: var(--bg-light);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Datos entrada box */
        .datos-entrada-box {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .datos-entrada-box h4 {
            font-size: 0.9rem;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .datos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 8px;
        }

        .dato-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
        }

        .dato-label {
            color: var(--text-secondary);
        }

        .dato-value {
            font-weight: 600;
            color: var(--primary);
        }

        /* Disclaimer */
        .disclaimer {
            background: #FEF3C7;
            border: 1px solid #F59E0B;
            border-radius: 12px;
            padding: 16px 20px;
            font-size: 0.8rem;
            color: #92400E;
            margin-top: 24px;
        }

        .disclaimer-title {
            font-weight: 700;
            margin-bottom: 6px;
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Spinner */
        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 12px; }
            .card { padding: 20px; }
            .header { padding: 30px 16px; }
            .progress-step { padding: 8px 14px; }
            .step-label { display: none; }
            .btn { width: 100%; }
            .btn-group { flex-direction: column; }
            .gender-toggle { flex-direction: column; }
            .resumen-grid { grid-template-columns: 1fr; }
            .tooltip-text { width: 220px; left: 0; transform: translateX(0); }
        }

        /* ============================================ */
        /* ESTILOS DE IMPRESI√ìN                        */
        /* ============================================ */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            body {
                background: white !important;
                font-size: 11px;
            }

            .container {
                max-width: 100%;
                padding: 0;
                margin: 0;
            }

            .no-print {
                display: none !important;
            }

            .header, .progress-container {
                display: none !important;
            }

            .card {
                box-shadow: none;
                border-radius: 0;
                padding: 20px;
                margin: 0;
                page-break-inside: avoid;
            }

            .resumen-ejecutivo {
                background: #1a1a2e !important;
                -webkit-print-color-adjust: exact;
            }

            .brecha-card {
                background: #FF6B6B !important;
            }

            .info-box {
                background: #f0fdf9 !important;
                border: 2px solid #00D4AA !important;
            }

            .cta-box {
                background: #1a1a2e !important;
            }

            .result-card {
                break-inside: avoid;
            }

            .results-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .btn-group {
                display: none !important;
            }

            @page {
                margin: 1cm;
                size: A4;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header no-print">
            <h1>üìä Calculadora de Pensi√≥n</h1>
            <p>Descubre cu√°nto recibir√°s en tu jubilaci√≥n y c√≥mo prepararte para el futuro</p>
        </header>

        <!-- Progress Steps -->
        <div class="progress-container no-print">
            <div class="progress-step active" id="progress-1">
                <span class="step-number">1</span>
                <span class="step-label">Datos Personales</span>
            </div>
            <div class="progress-step" id="progress-2">
                <span class="step-number">2</span>
                <span class="step-label">Datos Laborales</span>
            </div>
            <div class="progress-step" id="progress-3">
                <span class="step-number">3</span>
                <span class="step-label">Diagn√≥stico</span>
            </div>
        </div>

        <!-- Step 1: Datos Personales -->
        <div class="card" id="step1">
            <h2 class="card-title">
                <span class="card-title-icon">üë§</span>
                Datos Personales
            </h2>
            <div class="form-grid">
                <div class="form-group full-width">
                    <div class="label-row">
                        <label>Nombre completo</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text">Ingresa tu nombre completo. Esto nos ayuda a personalizar tu diagn√≥stico.</span>
                        </div>
                    </div>
                    <input type="text" id="nombre" placeholder="Ej: Juan P√©rez Garc√≠a" required>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>Correo electr√≥nico</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text">Tu correo para enviarte informaci√≥n adicional sobre estrategias de ahorro.</span>
                        </div>
                    </div>
                    <input type="email" id="email" placeholder="tucorreo@ejemplo.com" required>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>Tel√©fono</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text">N√∫mero de contacto para brindarte asesor√≠a personalizada.</span>
                        </div>
                    </div>
                    <input type="tel" id="telefono" placeholder="300 123 4567" required>
                </div>
                <div class="form-group full-width">
                    <div class="label-row">
                        <label>G√©nero</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text"><strong>Importante:</strong> La edad de pensi√≥n var√≠a. Hombres: 62 a√±os. Mujeres: 57 a√±os, con beneficios adicionales por hijos.</span>
                        </div>
                    </div>
                    <div class="gender-toggle">
                        <label class="gender-option" id="gender-hombre">
                            <input type="radio" name="genero" value="Hombre">
                            <div class="gender-icon">üë®</div>
                            <div class="gender-label">Hombre</div>
                            <div class="label-hint">Pensi√≥n a los 62 a√±os</div>
                        </label>
                        <label class="gender-option" id="gender-mujer">
                            <input type="radio" name="genero" value="Mujer">
                            <div class="gender-icon">üë©</div>
                            <div class="gender-label">Mujer</div>
                            <div class="label-hint">Pensi√≥n a los 57 a√±os</div>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>Edad actual</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text">Tu edad en a√±os cumplidos para calcular cu√°ntos a√±os te faltan para pensionarte.</span>
                        </div>
                    </div>
                    <input type="number" id="edad" placeholder="35" min="18" max="70" required>
                </div>
                <div class="form-group hidden" id="hijos-container">
                    <div class="label-row">
                        <label>N√∫mero de hijos</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text"><strong>Beneficio mujeres:</strong> -50 semanas por hijo (m√°x 3 hijos = 150 semanas menos).</span>
                        </div>
                    </div>
                    <select id="hijos">
                        <option value="0">0 hijos</option>
                        <option value="1">1 hijo</option>
                        <option value="2">2 hijos</option>
                        <option value="3">3 hijos o m√°s</option>
                    </select>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="goToStep(2)">Continuar <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Step 2: Datos Laborales -->
        <div class="card hidden" id="step2">
            <h2 class="card-title">
                <span class="card-title-icon">üíº</span>
                Datos Laborales y Pensionales
            </h2>
            <div class="form-grid">
                <div class="form-group">
                    <div class="label-row">
                        <label>IBL (Ingreso Base de Liquidaci√≥n)</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text"><strong>IBL:</strong> Promedio de salarios de los √∫ltimos 10 a√±os. Si no lo conoces, usa tu salario actual. Cons√∫ltalo en tu historia laboral de Colpensiones.</span>
                        </div>
                    </div>
                    <input type="text" id="ibl" placeholder="$5.000.000" required>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>Semanas cotizadas</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text"><strong>Semanas:</strong> Total aportado a pensi√≥n. Cons√∫ltalo en Colpensiones o tu fondo. 1 a√±o ‚âà 52 semanas.</span>
                        </div>
                    </div>
                    <input type="number" id="semanas" placeholder="800" min="0" max="3000" required>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>Salario M√≠nimo 2026</label>
                        <div class="tooltip-container">
                            <span class="tooltip-icon">?</span>
                            <span class="tooltip-text"><strong>SMLV:</strong> Se usa para calcular tasa de reemplazo y topes. Ed√≠talo si cambia.</span>
                        </div>
                    </div>
                    <input type="text" id="smlv" value="$1.750.905">
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="goToStep(1)"><span>‚Üê</span> Atr√°s</button>
                <button class="btn btn-primary" onclick="calcularPension()" id="btn-calcular">Ver mi diagn√≥stico <span>üìä</span></button>
            </div>
        </div>

        <!-- Step 3: Resultados -->
        <div class="card hidden" id="step3">
            <div id="resultados-content">
                
                <!-- Header para impresi√≥n -->
                <div style="text-align: center; margin-bottom: 20px; display: none;" id="print-header">
                    <h1 style="font-size: 1.5rem; color: var(--primary); margin-bottom: 5px;">üìä DIAGN√ìSTICO PENSIONAL</h1>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Generado el <span id="print-fecha"></span></p>
                </div>

                <h2 class="card-title no-print">
                    <span class="card-title-icon">üìã</span>
                    Tu Diagn√≥stico Pensional
                </h2>

                <p style="margin-bottom: 16px; color: var(--text-secondary);">
                    Diagn√≥stico para: <strong id="res-nombre" style="color: var(--primary);"></strong> 
                    <span id="print-fecha-inline" style="display: none;"> | <span id="print-fecha2"></span></span>
                </p>

                <!-- RESUMEN EJECUTIVO -->
                <div class="resumen-ejecutivo">
                    <h3>‚ö° RESUMEN EJECUTIVO</h3>
                    <div class="resumen-grid">
                        <div class="resumen-item">
                            <div class="resumen-item-label">Ingreso Actual</div>
                            <div class="resumen-item-value" id="res-ingreso-actual">$0</div>
                        </div>
                        <div class="resumen-item">
                            <div class="resumen-item-label">Mejor Pensi√≥n Estimada</div>
                            <div class="resumen-item-value" id="res-mejor-pension">$0</div>
                        </div>
                        <div class="resumen-item alerta">
                            <div class="resumen-item-label">Brecha Mensual</div>
                            <div class="resumen-item-value" id="res-brecha-resumen">-$0</div>
                        </div>
                    </div>
                    <div class="alerta-box">
                        <p>
                            <strong>‚ö†Ô∏è ATENCI√ìN:</strong> Al pensionarte, tu ingreso pasar√° de <strong id="res-de"></strong> a aproximadamente <strong id="res-a"></strong>. 
                            Esto representa una <strong>reducci√≥n del <span id="res-porcentaje">0</span>%</strong> en tu capacidad econ√≥mica mensual.
                        </p>
                        <p style="margin-top: 10px;">
                            <strong>Sin una estrategia de acumulaci√≥n paralela, podr√≠as enfrentar dificultades para mantener tu calidad de vida actual en el retiro.</strong>
                        </p>
                    </div>
                </div>

                <!-- Datos de entrada -->
                <div class="datos-entrada-box">
                    <h4>üìã Datos de Entrada</h4>
                    <div class="datos-grid">
                        <div class="dato-item">
                            <span class="dato-label">G√©nero:</span>
                            <span class="dato-value" id="res-genero">-</span>
                        </div>
                        <div class="dato-item">
                            <span class="dato-label">Edad actual:</span>
                            <span class="dato-value" id="res-edad">- a√±os</span>
                        </div>
                        <div class="dato-item">
                            <span class="dato-label">IBL:</span>
                            <span class="dato-value" id="res-ibl">$0</span>
                        </div>
                        <div class="dato-item">
                            <span class="dato-label">Semanas cotizadas:</span>
                            <span class="dato-value" id="res-semanas">0</span>
                        </div>
                        <div class="dato-item" id="res-hijos-container" style="display: none;">
                            <span class="dato-label">Hijos (beneficio):</span>
                            <span class="dato-value" id="res-hijos">0</span>
                        </div>
                        <div class="dato-item">
                            <span class="dato-label">SMLV usado:</span>
                            <span class="dato-value" id="res-smlv">$0</span>
                        </div>
                    </div>
                </div>

                <!-- Situaci√≥n pensional -->
                <div class="summary-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="res-edad-pension">62</div>
                        <div class="stat-label">Edad de pensi√≥n</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="res-anos-restantes">27</div>
                        <div class="stat-label">A√±os restantes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="res-semanas-actuales">500</div>
                        <div class="stat-label">Semanas actuales</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="res-semanas-proyectadas">1,800</div>
                        <div class="stat-label">Semanas proyectadas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="res-ano-pension">2050</div>
                        <div class="stat-label">A√±o de pensi√≥n</div>
                    </div>
                </div>

                <!-- Comparativo de Escenarios -->
                <h3 style="margin-bottom: 16px; color: var(--primary); font-size: 1.1rem;">üí∞ Comparativo de Escenarios</h3>
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-header">
                            <div class="result-icon colpensiones">üèõÔ∏è</div>
                            <div>
                                <div class="result-title">Colpensiones</div>
                                <div class="result-subtitle">R√©gimen de Prima Media</div>
                            </div>
                        </div>
                        <div class="result-value" id="res-colpensiones">$0</div>
                        <div class="result-range">Tasa base (R): <span id="res-tasa-r">0%</span></div>
                        <div class="result-range">Adicional (<span id="res-bloques">0</span> bloques): <span id="res-adicional">+0%</span></div>
                        <div class="result-range" style="font-weight: 600; color: var(--primary); margin-top: 4px;">Tasa final: <span id="res-tasa-colp">0%</span></div>
                    </div>

                    <div class="result-card">
                        <div class="result-header">
                            <div class="result-icon privado">üè¶</div>
                            <div>
                                <div class="result-title">Fondo Privado</div>
                                <div class="result-subtitle">Ahorro Individual (RAIS)</div>
                            </div>
                        </div>
                        <div class="result-value" id="res-privado-optimista">$0</div>
                        <div class="result-range">Rango: <span id="res-privado-conservador">$0</span> - <span id="res-privado-optimista-2">$0</span></div>
                    </div>

                    <div class="result-card highlight">
                        <div class="result-header">
                            <div class="result-icon reforma">‚öñÔ∏è</div>
                            <div>
                                <div class="result-title">Reforma Pensional</div>
                                <div class="result-subtitle">Sistema Mixto</div>
                            </div>
                        </div>
                        <div class="result-value" id="res-reforma-optimista">$0</div>
                        <div class="result-range">Rango: <span id="res-reforma-conservador">$0</span> - <span id="res-reforma-optimista-2">$0</span></div>
                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); font-size: 0.8rem;">
                            <div>Parte Colpensiones: <strong id="res-reforma-colp">$0</strong></div>
                            <div>Parte Privado: <strong id="res-reforma-priv">$0 - $0</strong></div>
                        </div>
                    </div>
                </div>

                <!-- Brecha Pensional destacada -->
                <div class="brecha-card">
                    <h3>‚ö†Ô∏è Tu Brecha Pensional Mensual</h3>
                    <div class="brecha-value" id="res-brecha">-$0</div>
                    <p class="brecha-text">Esta es la diferencia entre tu ingreso actual y tu mejor pensi√≥n estimada. Para mantener tu calidad de vida, necesitas cubrir esta brecha.</p>
                    <div class="porcentaje-reduccion">
                        üìâ Reducci√≥n del <strong id="res-porcentaje-2">0</strong>% de tu ingreso
                    </div>
                </div>

                <!-- Recomendaci√≥n -->
                <div class="info-box">
                    <h4>üí° ¬øC√≥mo cerrar esta brecha?</h4>
                    <p>Tienes <strong id="res-anos-restantes-2">0</strong> a√±os para construir un patrimonio que complemente tu pensi√≥n. La clave est√° en comenzar <strong>HOY</strong> con una estrategia de acumulaci√≥n paralela:</p>
                    <div class="estrategias-grid">
                        <span class="estrategia-tag">‚úì Pensi√≥n Voluntaria</span>
                        <span class="estrategia-tag">‚úì Fondos de Inversi√≥n</span>
                        <span class="estrategia-tag">‚úì Propiedad Ra√≠z</span>
                        <span class="estrategia-tag">‚úì Bolsa de Valores</span>
                        <span class="estrategia-tag">‚úì Capital Privado</span>
                    </div>
                </div>

                <!-- CTA -->
                <div class="cta-box">
                    <h4>¬øQuieres un plan personalizado para asegurar tu retiro?</h4>
                    <p>Agenda una asesor√≠a con nuestro equipo de expertos y descubre las mejores alternativas de inversi√≥n para tu perfil.</p>
                </div>

                <!-- Disclaimer -->
                <div class="disclaimer">
                    <div class="disclaimer-title">‚ö†Ô∏è Aviso Legal</div>
                    <p>Esta es una proyecci√≥n estimada con fines educativos. Las condiciones laborales, normativas y reformas pensionales pueden cambiar. Este c√°lculo no constituye asesor√≠a financiera formal. Los porcentajes del fondo privado (40%-45%) son estimaciones conservadoras. Consulta con un profesional certificado.</p>
                </div>
            </div>

            <div class="btn-group no-print">
                <button class="btn btn-secondary" onclick="goToStep(2)"><span>‚Üê</span> Modificar datos</button>
                <button class="btn btn-download" onclick="imprimirDiagnostico()"><span>üñ®Ô∏è</span> Imprimir / Guardar PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Google Sheets endpoint
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbzX-LMsgHtUd30MaSoJQoECfAe8X2Y-8ICJFGpBvUF9rjuIUv4gpg2MsB6Yg-10R1HUmw/exec';

        let resultadosCalculados = {};

        // Formatear moneda
        function formatCurrency(num) {
            return '$' + Math.round(num).toLocaleString('es-CO');
        }

        // Parsear moneda
        function parseCurrency(str) {
            return parseInt(str.replace(/[^\d]/g, '')) || 0;
        }

        // Formatear input moneda
        function formatCurrencyInput(input) {
            let value = input.value.replace(/[^\d]/g, '');
            if (value) {
                input.value = '$' + parseInt(value).toLocaleString('es-CO');
            }
        }

        // Event listeners
        document.getElementById('ibl').addEventListener('input', function() { formatCurrencyInput(this); });
        document.getElementById('smlv').addEventListener('input', function() { formatCurrencyInput(this); });

        document.querySelectorAll('.gender-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.gender-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input').checked = true;
                const hijosContainer = document.getElementById('hijos-container');
                if (this.querySelector('input').value === 'Mujer') {
                    hijosContainer.classList.remove('hidden');
                } else {
                    hijosContainer.classList.add('hidden');
                }
            });
        });

        // Navegaci√≥n
        function goToStep(step) {
            if (step === 2 && !validarPaso1()) return;
            document.querySelectorAll('.card').forEach(card => card.classList.add('hidden'));
            document.getElementById('step' + step).classList.remove('hidden');
            for (let i = 1; i <= 3; i++) {
                const progressStep = document.getElementById('progress-' + i);
                progressStep.classList.remove('active', 'completed');
                if (i < step) progressStep.classList.add('completed');
                else if (i === step) progressStep.classList.add('active');
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validarPaso1() {
            const nombre = document.getElementById('nombre').value.trim();
            const email = document.getElementById('email').value.trim();
            const telefono = document.getElementById('telefono').value.trim();
            const genero = document.querySelector('input[name="genero"]:checked');
            const edad = document.getElementById('edad').value;
            if (!nombre) { alert('Ingresa tu nombre completo'); return false; }
            if (!email || !email.includes('@')) { alert('Ingresa un correo v√°lido'); return false; }
            if (!telefono) { alert('Ingresa tu tel√©fono'); return false; }
            if (!genero) { alert('Selecciona tu g√©nero'); return false; }
            if (!edad || edad < 18 || edad > 70) { alert('Ingresa una edad v√°lida (18-70)'); return false; }
            return true;
        }

        function validarPaso2() {
            const ibl = parseCurrency(document.getElementById('ibl').value);
            const semanas = parseInt(document.getElementById('semanas').value);
            const smlv = parseCurrency(document.getElementById('smlv').value);
            if (!ibl) { alert('Ingresa tu IBL'); return false; }
            if (isNaN(semanas) || semanas < 0) { alert('Ingresa tus semanas cotizadas'); return false; }
            if (!smlv) { alert('Verifica el salario m√≠nimo'); return false; }
            return true;
        }

        function calcularSemanasRequeridasMujer(anoPension, hijos) {
            const anoBase = 2025, semanasBase = 1300, reduccionPorAno = 25, semanasMinimas = 1000;
            let anosTranscurridos = Math.max(0, anoPension - anoBase);
            let semanasAno = Math.max(semanasMinimas, semanasBase - (anosTranscurridos * reduccionPorAno));
            return Math.max(850, semanasAno - (Math.min(hijos, 3) * 50));
        }

        function calcularPension() {
            if (!validarPaso2()) return;
            const btn = document.getElementById('btn-calcular');
            btn.innerHTML = '<span class="spinner"></span> Calculando...';
            btn.disabled = true;

            const nombre = document.getElementById('nombre').value.trim();
            const email = document.getElementById('email').value.trim();
            const telefono = document.getElementById('telefono').value.trim();
            const genero = document.querySelector('input[name="genero"]:checked').value;
            const edad = parseInt(document.getElementById('edad').value);
            const hijos = genero === 'Mujer' ? parseInt(document.getElementById('hijos').value) : 0;
            const ibl = parseCurrency(document.getElementById('ibl').value);
            const semanasCotizadas = parseInt(document.getElementById('semanas').value);
            const smlv = parseCurrency(document.getElementById('smlv').value);

            const edadPension = genero === 'Hombre' ? 62 : 57;
            const anosRestantes = Math.max(0, edadPension - edad);
            const anoActual = 2026;
            const anoPension = anoActual + anosRestantes;

            let semanasRequeridas = genero === 'Hombre' ? 1300 : calcularSemanasRequeridasMujer(anoPension, hijos);
            
            // Proyectar semanas a la edad de pensi√≥n (52 semanas por a√±o)
            const semanasProyectadas = semanasCotizadas + (anosRestantes * 52);
            const semanasFaltantes = Math.max(0, semanasRequeridas - semanasCotizadas);

            // =====================================================
            // CASO 1: COLPENSIONES (L√≥gica Colpensiones)
            // =====================================================
            // R = tasa base seg√∫n IBL
            // Adicional = por cada 50 semanas despu√©s de 1300, +1.5% (m√°x 15%)
            // Pensi√≥n = IBL √ó (R + Adicional)
            
            const S = ibl / smlv;
            let R = 65.5 - (0.5 * S);
            
            // Calcular adicional con semanas PROYECTADAS, tope 1800
            const semanasParaCalculo = Math.min(semanasProyectadas, 1800);
            const semanasBase = 1300;
            const semanasAdicionales = Math.max(0, semanasParaCalculo - semanasBase);
            const bloques = Math.floor(semanasAdicionales / 50); // M√°ximo 10 bloques
            const adicional = bloques * 1.5; // M√°ximo 15%
            
            const tasaFinalColp = R + adicional;
            let pensionColpensiones = ibl * (tasaFinalColp / 100);
            
            // Aplicar topes
            const pensionMinima = smlv;
            const pensionMaxima = smlv * 25;
            pensionColpensiones = Math.max(pensionMinima, Math.min(pensionMaxima, pensionColpensiones));

            // =====================================================
            // CASO 2: FONDO PRIVADO
            // =====================================================
            // Conservador: 40% del IBL
            // Optimista: 45% del IBL
            
            let pensionPrivadoConservador = ibl * 0.40;
            let pensionPrivadoOptimista = ibl * 0.45;
            
            // Aplicar topes
            pensionPrivadoConservador = Math.max(pensionMinima, Math.min(pensionMaxima, pensionPrivadoConservador));
            pensionPrivadoOptimista = Math.max(pensionMinima, Math.min(pensionMaxima, pensionPrivadoOptimista));

            // =====================================================
            // CASO 3: REFORMA (Sistema Mixto)
            // =====================================================
            // Parte Colpensiones: primeros 2.5 SMLV con L√≥gica Colpensiones
            // Parte Privado: excedente con L√≥gica Privado (40%-45%)
            // Total = Parte Colpensiones + Parte Privado
            
            const iblReformaColp = Math.min(ibl, smlv * 2.5); // M√°ximo 2.5 SMLV
            const iblReformaPriv = Math.max(0, ibl - (smlv * 2.5)); // Excedente
            
            // Aplicar L√≥gica Colpensiones sobre 2.5 SMLV
            const S_reforma = iblReformaColp / smlv;
            const R_reforma = 65.5 - (0.5 * S_reforma);
            const tasaFinalReformaColp = R_reforma + adicional; // Mismo adicional por semanas
            let pensionReformaColp = iblReformaColp * (tasaFinalReformaColp / 100);
            
            // Aplicar L√≥gica Privado sobre excedente
            let pensionReformaPrivConservador = iblReformaPriv * 0.40;
            let pensionReformaPrivOptimista = iblReformaPriv * 0.45;
            
            // Sumar ambas partes
            let pensionReformaTotalConservador = pensionReformaColp + pensionReformaPrivConservador;
            let pensionReformaTotalOptimista = pensionReformaColp + pensionReformaPrivOptimista;
            
            // Aplicar topes al total
            pensionReformaTotalConservador = Math.max(pensionMinima, Math.min(pensionMaxima, pensionReformaTotalConservador));
            pensionReformaTotalOptimista = Math.max(pensionMinima, Math.min(pensionMaxima, pensionReformaTotalOptimista));

            const mejorPension = Math.max(pensionColpensiones, pensionPrivadoOptimista, pensionReformaTotalOptimista);
            const brechaPensional = ibl - mejorPension;
            const porcentajeReduccion = ((brechaPensional / ibl) * 100).toFixed(0);

            resultadosCalculados = {
                nombre, email, telefono, genero, edad, hijos, ibl, semanasCotizadas, smlv,
                semanasProyectadas,
                pensionColpensiones: Math.round(pensionColpensiones),
                pensionPrivadoConservador: Math.round(pensionPrivadoConservador),
                pensionPrivadoOptimista: Math.round(pensionPrivadoOptimista),
                pensionReformaConservador: Math.round(pensionReformaTotalConservador),
                pensionReformaOptimista: Math.round(pensionReformaTotalOptimista),
                brechaPensional: Math.round(brechaPensional),
                anoEstimadoPension: anoPension,
                semanasRequeridas, semanasFaltantes, edadPension, anosRestantes,
                R: R,
                adicional: adicional,
                tasaFinalColp,
                bloques,
                pensionReformaColp: Math.round(pensionReformaColp),
                pensionReformaPrivConservador: Math.round(pensionReformaPrivConservador),
                pensionReformaPrivOptimista: Math.round(pensionReformaPrivOptimista),
                mejorPension: Math.round(mejorPension),
                porcentajeReduccion
            };

            enviarAGoogleSheets(resultadosCalculados)
                .then(() => { mostrarResultados(resultadosCalculados); goToStep(3); })
                .catch(() => { mostrarResultados(resultadosCalculados); goToStep(3); })
                .finally(() => { btn.innerHTML = 'Ver mi diagn√≥stico <span>üìä</span>'; btn.disabled = false; });
        }

        async function enviarAGoogleSheets(datos) {
            try {
                await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST', mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(datos)
                });
            } catch (e) { console.error(e); }
        }

        function mostrarResultados(res) {
            // Resumen ejecutivo
            document.getElementById('res-ingreso-actual').textContent = formatCurrency(res.ibl);
            document.getElementById('res-mejor-pension').textContent = formatCurrency(res.mejorPension);
            document.getElementById('res-brecha-resumen').textContent = '-' + formatCurrency(Math.abs(res.brechaPensional));
            document.getElementById('res-de').textContent = formatCurrency(res.ibl);
            document.getElementById('res-a').textContent = formatCurrency(res.mejorPension);
            document.getElementById('res-porcentaje').textContent = Math.abs(res.porcentajeReduccion);

            // Datos entrada
            document.getElementById('res-nombre').textContent = res.nombre;
            document.getElementById('res-genero').textContent = res.genero;
            document.getElementById('res-edad').textContent = res.edad + ' a√±os';
            document.getElementById('res-ibl').textContent = formatCurrency(res.ibl);
            document.getElementById('res-semanas').textContent = res.semanasCotizadas.toLocaleString('es-CO');
            document.getElementById('res-smlv').textContent = formatCurrency(res.smlv);
            if (res.genero === 'Mujer') {
                document.getElementById('res-hijos-container').style.display = 'flex';
                document.getElementById('res-hijos').textContent = res.hijos;
            }

            // Situaci√≥n
            document.getElementById('res-edad-pension').textContent = res.edadPension;
            document.getElementById('res-anos-restantes').textContent = res.anosRestantes;
            document.getElementById('res-semanas-actuales').textContent = res.semanasCotizadas.toLocaleString('es-CO');
            document.getElementById('res-semanas-proyectadas').textContent = Math.min(res.semanasProyectadas, 1800).toLocaleString('es-CO');
            document.getElementById('res-ano-pension').textContent = res.anoEstimadoPension;

            // Escenarios
            document.getElementById('res-colpensiones').textContent = formatCurrency(res.pensionColpensiones);
            document.getElementById('res-tasa-r').textContent = res.R.toFixed(2) + '%';
            document.getElementById('res-bloques').textContent = res.bloques;
            document.getElementById('res-adicional').textContent = '+' + res.adicional.toFixed(1) + '%';
            document.getElementById('res-tasa-colp').textContent = res.tasaFinalColp.toFixed(2) + '%';
            document.getElementById('res-privado-optimista').textContent = formatCurrency(res.pensionPrivadoOptimista);
            document.getElementById('res-privado-conservador').textContent = formatCurrency(res.pensionPrivadoConservador);
            document.getElementById('res-privado-optimista-2').textContent = formatCurrency(res.pensionPrivadoOptimista);
            document.getElementById('res-reforma-optimista').textContent = formatCurrency(res.pensionReformaOptimista);
            document.getElementById('res-reforma-conservador').textContent = formatCurrency(res.pensionReformaConservador);
            document.getElementById('res-reforma-optimista-2').textContent = formatCurrency(res.pensionReformaOptimista);
            document.getElementById('res-reforma-colp').textContent = formatCurrency(res.pensionReformaColp);
            document.getElementById('res-reforma-priv').textContent = formatCurrency(res.pensionReformaPrivConservador) + ' - ' + formatCurrency(res.pensionReformaPrivOptimista);

            // Brecha
            document.getElementById('res-brecha').textContent = '-' + formatCurrency(Math.abs(res.brechaPensional));
            document.getElementById('res-porcentaje-2').textContent = Math.abs(res.porcentajeReduccion);
            document.getElementById('res-anos-restantes-2').textContent = res.anosRestantes;

            // Fecha
            const fecha = new Date().toLocaleDateString('es-CO', { year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('print-fecha').textContent = fecha;
            document.getElementById('print-fecha2').textContent = fecha;
        }

        function imprimirDiagnostico() {
            document.getElementById('print-header').style.display = 'block';
            document.getElementById('print-fecha-inline').style.display = 'inline';
            window.print();
            setTimeout(() => {
                document.getElementById('print-header').style.display = 'none';
                document.getElementById('print-fecha-inline').style.display = 'none';
            }, 1000);
        }
    </script>
</body>
</html>
